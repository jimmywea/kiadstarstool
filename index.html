<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Ứng dụng điểm danh học sinh cho các lớp học như Piano, Guitar, Thanh nhạc, Vẽ và hơn thế nữa.">
  <title>Ứng dụng Điểm danh Học sinh</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
  <!-- Khu vực đăng nhập -->
  <div id="auth-section">
    <h2>Đăng nhập</h2>
    <form onsubmit="event.preventDefault(); loginUser(document.getElementById('email').value, document.getElementById('password').value);">
      <input type="email" id="email" placeholder="Email" required>
      <input type="password" id="password" placeholder="Mật khẩu" required>
      <button type="submit">Đăng nhập</button>
    </form>
  </div>

  <!-- Ứng dụng chính -->
  <div id="app" style="display: none;">
    <!-- Thanh điều hướng -->
    <nav class="nav">
      <button onclick="showSection('attendance')">Điểm danh</button>
      <button onclick="showSection('query-student')">Truy vấn học sinh</button>
      <button onclick="showSection('query-time')">Truy vấn thời gian</button>
      <button onclick="showSection('add-student')">Thêm học sinh</button>
    </nav>

    <!-- Điểm danh -->
    <section id="attendance" class="section">
      <h2>Điểm danh học sinh</h2>
      <form onsubmit="event.preventDefault(); markAttendance();">
        <input type="text" id="student-name" placeholder="Tên học sinh" oninput="suggestStudentNames('student-name', 'attendance-suggestions')" required minlength="3">
        <ul id="attendance-suggestions" class="suggestions-list"></ul>
        <input type="datetime-local" id="attendance-time" required>
        <select id="attendance-class" required>
          <option value="">Chọn lớp học</option>
          <option value="Piano">Piano</option>
          <option value="Guitar">Guitar</option>
          <option value="Vocal">Thanh nhạc</option>
          <option value="Drawing">Vẽ</option>
          <option value="Dance">Nhảy</option>
          <option value="MC">MC</option>
        </select>
        <textarea id="attendance-content" placeholder="Nội dung buổi học"></textarea>
        <label>
          <input type="checkbox" id="absent-checkbox"> Vắng mặt
        </label>
        <button type="submit">Điểm danh</button>
      </form>
      <p id="attendance-status"></p>
    </section>

    <!-- Truy vấn học sinh -->
    <section id="query-student" class="section hidden">
      <h2>Truy vấn học sinh</h2>
      <form onsubmit="event.preventDefault(); queryStudent();">
        <input type="text" id="query-student-name" placeholder="Tên học sinh" oninput="suggestStudentNames('query-student-name', 'query-student-suggestions')">
        <ul id="query-student-suggestions" class="suggestions-list"></ul>
        <input type="date" id="query-student-start-date" required>
        <input type="date" id="query-student-end-date" required>
        <button type="submit">Truy vấn</button>
      </form>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Tên học sinh</th>
              <th>Thời gian</th>
              <th>Môn học</th>
              <th>Trạng thái</th>
              <th>Nội dung</th>
            </tr>
          </thead>
          <tbody id="query-student-result"></tbody>
        </table>
      </div>
      <button id="export-student-excel" style="display:none;" onclick="exportToExcel()">Xuất ra Excel</button>
    </section>

    <!-- Truy vấn thời gian -->
    <section id="query-time" class="section hidden">
      <h2>Truy vấn theo thời gian</h2>
      <form onsubmit="event.preventDefault(); queryByTime();">
        <input type="date" id="query-time-start-date" required>
        <input type="date" id="query-time-end-date" required>
        <input type="time" id="query-start-time" required>
        <input type="time" id="query-end-time" required>
        <select id="query-time-class">
          <option value="">Tất cả môn học</option>
          <option value="Piano">Piano</option>
          <option value="Guitar">Guitar</option>
          <option value="Vocal">Thanh nhạc</option>
          <option value="Drawing">Vẽ</option>
          <option value="Dance">Nhảy</option>
          <option value="MC">MC</option>
        </select>
        <button type="submit">Truy vấn</button>
      </form>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Tên học sinh</th>
              <th>Thời gian</th>
              <th>Môn học</th>
              <th>Trạng thái</th>
              <th>Nội dung</th>
            </tr>
          </thead>
          <tbody id="query-time-result"></tbody>
        </table>
      </div>
    </section>

    <!-- Thêm học sinh -->
    <section id="add-student" class="section hidden">
      <h2>Thêm học sinh</h2>
      <form onsubmit="event.preventDefault(); addStudent();">
        <input type="text" id="new-student-name" placeholder="Tên học sinh" required minlength="3">
        <input type="number" id="number-of-lessons" placeholder="Số buổi học" required min="1">
        <div class="checkbox-group">
          <label><input type="checkbox" id="piano"> Piano</label>
          <label><input type="checkbox" id="guitar"> Guitar</label>
          <label><input type="checkbox" id="vocal"> Thanh nhạc</label>
          <label><input type="checkbox" id="drawing"> Vẽ</label>
          <label><input type="checkbox" id="dance"> Nhảy</label>
          <label><input type="checkbox" id="mc"> MC</label>
        </div>
        <button type="submit">Thêm học sinh</button>
      </form>
      <p id="add-student-status"></p>
    </section>
  </div>

  <script type="module" src="script.js"></script>
</body>
</html>
